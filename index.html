<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Snake Strike</title>
  <style>
    :root { --bg: #ffffff; --text: #1a1a1a; --danger: #ff3b30; --accent: #007aff; }
    * { box-sizing: border-box; touch-action: none; user-select: none; }
    body { margin: 0; background: var(--bg); color: var(--text); font-family: sans-serif; overflow: hidden; }

    /* HUD (Score & Pause) */
    .hud {
      position: absolute; top: 10px; left: 10px; right: 10px;
      display: flex; justify-content: space-between; align-items: flex-start;
      z-index: 10; pointer-events: none;
    }
    .hud-box { 
      background: rgba(255,255,255,0.8); backdrop-filter: blur(10px);
      padding: 8px 15px; border-radius: 12px; pointer-events: auto;
      border: 1px solid rgba(0,0,0,0.1); box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    .pause-btn {
      width: 42px; height: 42px; border-radius: 50%; background: #000;
      color: #fff; display: flex; align-items: center; justify-content: center;
      font-weight: bold; cursor: pointer; pointer-events: auto; font-size: 20px;
    }

    /* Game Board */
    #game-container { position: relative; width: 100vw; height: 100vh; display: flex; align-items: center; justify-content: center;}
    canvas { display: block; background: #fff; }
    .flash-red { animation: flash 0.3s 3; }
    @keyframes flash { 50% { background: #ff7675; } }

    /* Overlays */
    .overlay {
      position: fixed; inset: 0; background: rgba(255,255,255,0.9); backdrop-filter: blur(8px);
      z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center;
      padding: 20px; text-align: center;
    }
    .hidden { display: none !important; }
    
    .card {
      background: #fff; padding: 30px; border-radius: 25px;
      box-shadow: 0 20px 50px rgba(0,0,0,0.15); border: 1px solid rgba(0,0,0,0.05);
      width: min(90%, 350px);
    }
    .medal-icon { font-size: 60px; margin-bottom: 10px; display: block; }
    .score-big { font-size: 40px; font-weight: 900; margin: 10px 0; color: var(--text); }
    
    .btn {
      width: 100%; padding: 16px; font-size: 1.1rem; font-weight: bold;
      background: #000; color: #fff; border: none; border-radius: 15px;
      margin-top: 20px; cursor: pointer; transition: transform 0.2s;
    }
    .btn:active { transform: scale(0.95); }
    .btn-secondary { background: #f0f0f0; color: #000; margin-top: 10px; }
    .rules-list { text-align: left; font-size: 0.9rem; line-height: 1.6; background: #f9f9f9; padding: 15px; border-radius: 12px; margin-top: 15px;}
  </style>
</head>
<body>

  <div class="hud">
    <div class="hud-box">
      Score: <b id="score">0</b> / 100<br>
      Best: <b id="best">0</b>
    </div>
    <div class="pause-btn" id="pauseBtn">?</div>
  </div>

  <div id="startMenu" class="overlay">
    <div class="card">
      <h1 style="margin-top:0">SNAKE STRIKE</h1>
      <button class="btn" id="playBtn">START GAME</button>
      <button class="btn btn-secondary" id="ruleInfoBtn">RULES</button>
    </div>
  </div>

  <div id="rulesOverlay" class="overlay hidden">
    <div class="card">
      <h2>Rules üìú</h2>
      <div class="rules-list">
        ‚Ä¢ Swipe/arrow_key/WASD_key to move Snake.<br>
        ‚Ä¢ <b>Mongoose ü¶¶</b> will appear if the score is more than 5<br>
        ‚Ä¢ The mongoose will chase you and kill you.<br>
        ‚Ä¢ eat üíé for freeze mongoose (üßä).<br>
        ‚Ä¢ Eat üçé =  +1 score<br>
        ‚Ä¢ 100 Points = Win<b>(GOLD MEDAL)</b>!
      </div>
      <button class="btn" id="resumeBtn">CONTINUE</button>
    </div>
  </div>

  <div id="gameOverOverlay" class="overlay hidden">
    <div class="card">
      <span id="resultIcon" class="medal-icon">ü•â</span>
      <h2 id="resultStatus" style="margin:0; opacity:0.6">GAME OVER</h2>
      <div id="resultScore" class="score-big">0</div>
      <p id="resultMedalText" style="font-weight:bold; color:var(--accent)">BRONZE MEDAL</p>
      <button class="btn" id="restartBtn">PLAY AGAIN</button>
      <button class="btn btn-secondary" id="mainMenuBtn">MAIN MENU</button>
    </div>
  </div>

  <div id="game-container">
    <canvas id="game"></canvas>
  </div>

<script>
  const cvs = document.getElementById('game');
  const ctx = cvs.getContext('2d');
  
  let cell, cols, rows, w, h;
  let S = {};

  function setup() {
    w = window.innerWidth; h = window.innerHeight;
    cvs.width = w; cvs.height = h;
    cell = Math.floor(Math.min(w, h) / 18);
    cols = Math.floor(w/cell); rows = Math.floor(h/cell);
  }
  window.onresize = setup;
  setup();

  function spawn() {
    return { x: Math.floor(Math.random()*cols), y: Math.floor(Math.random()*rows), t: Math.random()>0.9?'üíé':'üçé' };
  }

  function reset() {
    S = {
      snake: [{x:10,y:10},{x:9,y:10},{x:8,y:10}],
      dir: {x:1,y:0}, next: {x:1,y:0},
      food: [spawn(), spawn()],
      nevla: null, score: 0, 
      best: localStorage.getItem('s_best_v7') || 0,
      active: false, paused: false, stun: 0
    };
    document.getElementById('score').innerText = 0;
    document.getElementById('best').innerText = S.best;
    cvs.classList.remove('flash-red');
  }

  
  let sx, sy;
  document.ontouchstart = e => { sx = e.touches[0].clientX; sy = e.touches[0].clientY; };
  document.ontouchend = e => {
    const dx = e.changedTouches[0].clientX - sx, dy = e.changedTouches[0].clientY - sy;
    if (Math.abs(dx) > Math.abs(dy)) {
      if (Math.abs(dx)>25 && S.dir.x==0) S.next={x:dx>0?1:-1, y:0};
    } else {
      if (Math.abs(dy)>25 && S.dir.y==0) S.next={x:0, y:dy>0?1:-1};
    }
  };
  function setDir(x,y) { S.next={x,y}; }

  function update() {
    if (!S.active || S.paused) return;
    S.dir = S.next;
    const head = { x: (S.snake[0].x+S.dir.x+cols)%cols, y: (S.snake[0].y+S.dir.y+rows)%rows };

    if (S.snake.some(b=>b.x===head.x && b.y===head.y)) return showResult("Snake Crashed!");
    S.snake.unshift(head);

    const fIdx = S.food.findIndex(f=>f.x===head.x && f.y===head.y);
    if (fIdx > -1) {
      S.score += S.food[fIdx].t==='üíé'?5:1;
      if (S.food[fIdx].t==='üíé') S.stun = 40;
      document.getElementById('score').innerText = S.score;
      S.food[fIdx] = spawn();
      
      if (S.score >= 5 && !S.nevla) {
        S.nevla = {x:0, y:0};
        cvs.classList.add('flash-red');
        setTimeout(()=>cvs.classList.remove('flash-red'), 1000);
      }
      if (S.score >= 100) return showResult("VICTORY!");
    } else { S.snake.pop(); }

    if (S.nevla) {
      if (S.stun > 0) S.stun--;
      else if (Math.random()>0.6) {
        if (S.nevla.x < head.x) S.nevla.x++; else if (S.nevla.x > head.x) S.nevla.x--;
        if (S.nevla.y < head.y) S.nevla.y++; else if (S.nevla.y > head.y) S.nevla.y--;
      }
      for(let ix=0; ix<2; ix++) {
        for(let iy=0; iy<2; iy++) {
          let nx = S.nevla.x + ix, ny = S.nevla.y + iy;
          if (head.x === nx && head.y === ny) return showResult("Nevla ne pakad liya!");
          const hit = S.snake.findIndex((b,i)=> i>0 && b.x===nx && b.y===ny);
          if (hit > 0) { S.snake.splice(hit); if(S.snake.length<3) return showResult("Snake is too small!"); }
        }
      }
    }
  }

  function draw() {
    ctx.clearRect(0,0,w,h);
    
    
    ctx.strokeStyle = 'rgba(0,0,0,0.05)';
    for(let i=0; i<w; i+=cell) { ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,h); ctx.stroke(); }
    for(let j=0; j<h; j+=cell) { ctx.beginPath(); ctx.moveTo(0,j); ctx.lineTo(w,j); ctx.stroke(); }

    
    ctx.font = `${cell*0.8}px serif`;
    S.food.forEach(f => ctx.fillText(f.t, f.x*cell, f.y*cell+cell*0.8));

   
    S.snake.forEach((b, i) => {
      ctx.fillStyle = i === 0 ? '#1a1a1a' : '#28cd41';
      ctx.beginPath();
      ctx.roundRect(b.x * cell + 1, b.y * cell + 1, cell - 2, cell - 2, 6);
      ctx.fill();
    });

    
    if (S.nevla) {
      if (S.stun > 0) {
        ctx.font = `${cell*1.5}px serif`;
        ctx.fillText('üßä', S.nevla.x*cell, S.nevla.y*cell+cell*1.5);
      } else {
        ctx.font = `${cell*1.7}px serif`;
        ctx.fillText('ü¶¶', S.nevla.x*cell, S.nevla.y*cell+cell*1.6);
      }
    }
  }

  function showResult(statusText) {
    S.active = false;
    if (S.score > S.best) { S.best = S.score; localStorage.setItem('s_best_v7', S.score); }
    
    let medal = "ü•â", txt = "BRONZE MEDAL", color = "#cd7f32";
    if(S.score >= 100) { medal="ü•á"; txt="GOLD MEDAL"; color="#ffd700"; }
    else if(S.score >= 50) { medal="ü•à"; txt="SILVER MEDAL"; color="#c0c0c0"; }

    document.getElementById('resultIcon').innerText = medal;
    document.getElementById('resultStatus').innerText = statusText.toUpperCase();
    document.getElementById('resultScore').innerText = S.score;
    document.getElementById('resultMedalText').innerText = txt;
    document.getElementById('resultMedalText').style.color = color;
    document.getElementById('gameOverOverlay').classList.remove('hidden');
  }

  document.getElementById('playBtn').onclick = () => { reset(); S.active = true; document.getElementById('startMenu').classList.add('hidden'); };
  document.getElementById('restartBtn').onclick = () => { reset(); S.active = true; document.getElementById('gameOverOverlay').classList.add('hidden'); };
  document.getElementById('mainMenuBtn').onclick = () => { document.getElementById('gameOverOverlay').classList.add('hidden'); document.getElementById('startMenu').classList.remove('hidden'); };
  document.getElementById('ruleInfoBtn').onclick = () => document.getElementById('rulesOverlay').classList.remove('hidden');
  document.getElementById('pauseBtn').onclick = () => { if(S.active){S.paused = true; document.getElementById('rulesOverlay').classList.remove('hidden');} };
  document.getElementById('resumeBtn').onclick = () => { document.getElementById('rulesOverlay').classList.add('hidden'); S.paused = false; };

  reset();
  setInterval(() => { update(); draw(); }, 140);
</script>
</body>
</html>
